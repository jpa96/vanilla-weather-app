
let apiCode = [
	{
		"code" : 1000,
		"day" : "Sunny",
		"night" : "Clear",
		"icon" : 113
	},
	{
		"code" : 1003,
		"day" : "Partly cloudy",
		"night" : "Partly cloudy",
		"icon" : 116
	},
	{
		"code" : 1006,
		"day" : "Cloudy",
		"night" : "Cloudy",
		"icon" : 119
	},
	{
		"code" : 1009,
		"day" : "Overcast",
		"night" : "Overcast",
		"icon" : 122
	},
	{
		"code" : 1030,
		"day" : "Mist",
		"night" : "Mist",
		"icon" : 143
	},
	{
		"code" : 1063,
		"day" : "Patchy rain possible",
		"night" : "Patchy rain possible",
		"icon" : 176
	},
	{
		"code" : 1066,
		"day" : "Patchy snow possible",
		"night" : "Patchy snow possible",
		"icon" : 179
	},
	{
		"code" : 1069,
		"day" : "Patchy sleet possible",
		"night" : "Patchy sleet possible",
		"icon" : 182
	},
	{
		"code" : 1072,
		"day" : "Patchy freezing drizzle possible",
		"night" : "Patchy freezing drizzle possible",
		"icon" : 185
	},
	{
		"code" : 1087,
		"day" : "Thundery outbreaks possible",
		"night" : "Thundery outbreaks possible",
		"icon" : 200
	},
	{
		"code" : 1114,
		"day" : "Blowing snow",
		"night" : "Blowing snow",
		"icon" : 227
	},
	{
		"code" : 1117,
		"day" : "Blizzard",
		"night" : "Blizzard",
		"icon" : 230
	},
	{
		"code" : 1135,
		"day" : "Fog",
		"night" : "Fog",
		"icon" : 248
	},
	{
		"code" : 1147,
		"day" : "Freezing fog",
		"night" : "Freezing fog",
		"icon" : 260
	},
	{
		"code" : 1150,
		"day" : "Patchy light drizzle",
		"night" : "Patchy light drizzle",
		"icon" : 263
	},
	{
		"code" : 1153,
		"day" : "Light drizzle",
		"night" : "Light drizzle",
		"icon" : 266
	},
	{
		"code" : 1168,
		"day" : "Freezing drizzle",
		"night" : "Freezing drizzle",
		"icon" : 281
	},
	{
		"code" : 1171,
		"day" : "Heavy freezing drizzle",
		"night" : "Heavy freezing drizzle",
		"icon" : 284
	},
	{
		"code" : 1180,
		"day" : "Patchy light rain",
		"night" : "Patchy light rain",
		"icon" : 293
	},
	{
		"code" : 1183,
		"day" : "Light rain",
		"night" : "Light rain",
		"icon" : 296
	},
	{
		"code" : 1186,
		"day" : "Moderate rain at times",
		"night" : "Moderate rain at times",
		"icon" : 299
	},
	{
		"code" : 1189,
		"day" : "Moderate rain",
		"night" : "Moderate rain",
		"icon" : 302
	},
	{
		"code" : 1192,
		"day" : "Heavy rain at times",
		"night" : "Heavy rain at times",
		"icon" : 305
	},
	{
		"code" : 1195,
		"day" : "Heavy rain",
		"night" : "Heavy rain",
		"icon" : 308
	},
	{
		"code" : 1198,
		"day" : "Light freezing rain",
		"night" : "Light freezing rain",
		"icon" : 311
	},
	{
		"code" : 1201,
		"day" : "Moderate or heavy freezing rain",
		"night" : "Moderate or heavy freezing rain",
		"icon" : 314
	},
	{
		"code" : 1204,
		"day" : "Light sleet",
		"night" : "Light sleet",
		"icon" : 317
	},
	{
		"code" : 1207,
		"day" : "Moderate or heavy sleet",
		"night" : "Moderate or heavy sleet",
		"icon" : 320
	},
	{
		"code" : 1210,
		"day" : "Patchy light snow",
		"night" : "Patchy light snow",
		"icon" : 323
	},
	{
		"code" : 1213,
		"day" : "Light snow",
		"night" : "Light snow",
		"icon" : 326
	},
	{
		"code" : 1216,
		"day" : "Patchy moderate snow",
		"night" : "Patchy moderate snow",
		"icon" : 329
	},
	{
		"code" : 1219,
		"day" : "Moderate snow",
		"night" : "Moderate snow",
		"icon" : 332
	},
	{
		"code" : 1222,
		"day" : "Patchy heavy snow",
		"night" : "Patchy heavy snow",
		"icon" : 335
	},
	{
		"code" : 1225,
		"day" : "Heavy snow",
		"night" : "Heavy snow",
		"icon" : 338
	},
	{
		"code" : 1237,
		"day" : "Ice pellets",
		"night" : "Ice pellets",
		"icon" : 350
	},
	{
		"code" : 1240,
		"day" : "Light rain shower",
		"night" : "Light rain shower",
		"icon" : 353
	},
	{
		"code" : 1243,
		"day" : "Moderate or heavy rain shower",
		"night" : "Moderate or heavy rain shower",
		"icon" : 356
	},
	{
		"code" : 1246,
		"day" : "Torrential rain shower",
		"night" : "Torrential rain shower",
		"icon" : 359
	},
	{
		"code" : 1249,
		"day" : "Light sleet showers",
		"night" : "Light sleet showers",
		"icon" : 362
	},
	{
		"code" : 1252,
		"day" : "Moderate or heavy sleet showers",
		"night" : "Moderate or heavy sleet showers",
		"icon" : 365
	},
	{
		"code" : 1255,
		"day" : "Light snow showers",
		"night" : "Light snow showers",
		"icon" : 368
	},
	{
		"code" : 1258,
		"day" : "Moderate or heavy snow showers",
		"night" : "Moderate or heavy snow showers",
		"icon" : 371
	},
	{
		"code" : 1261,
		"day" : "Light showers of ice pellets",
		"night" : "Light showers of ice pellets",
		"icon" : 374
	},
	{
		"code" : 1264,
		"day" : "Moderate or heavy showers of ice pellets",
		"night" : "Moderate or heavy showers of ice pellets",
		"icon" : 377
	},
	{
		"code" : 1273,
		"day" : "Patchy light rain with thunder",
		"night" : "Patchy light rain with thunder",
		"icon" : 386
	},
	{
		"code" : 1276,
		"day" : "Moderate or heavy rain with thunder",
		"night" : "Moderate or heavy rain with thunder",
		"icon" : 389
	},
	{
		"code" : 1279,
		"day" : "Patchy light snow with thunder",
		"night" : "Patchy light snow with thunder",
		"icon" : 392
	},
	{
		"code" : 1282,
		"day" : "Moderate or heavy snow with thunder",
		"night" : "Moderate or heavy snow with thunder",
		"icon" : 395
	}
]

//WANT TO CHANGE OWN ICONS TO MATCH WEATHER CONDITION CODES OF API

function formatTime(timestamp) {
    //calculate time ***WANT TO MAKE THE WEATHER TO BE IN REAL-TIME
    let time = new Date(timestamp);
    let hours = time.getHours();
    let minutes = time.getMinutes();
    if (hours < 10) {
      hours = `0${hours}`
    }
    if (minutes < 10) {
        minutes = `0${minutes}`
    }
    return `${hours}:${minutes}`
}

function formatDate(timestamp) {
    
    let days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    let months = ["January", "February", "March", "April", "May", "June", "July", "August", "August", "September", "October", "November", "December"];
    //calculate date
    let date = new Date(timestamp);
    let day = days[date.getDay()];
    let currentDate = date.getDate();
    let month = months[date.getMonth()];
    let year = date.getFullYear();

    let formattedDate = `${day}, ${currentDate} ${month} ${year}`;
    return formattedDate;
}

function showTodaysData(response) {
    
    timeElement = document.querySelector("#current-time");
    timeElement.innerHTML = formatTime(response.data.location.localtime);
    
    dateElement = document.querySelector("#date");
    dateElement.innerHTML = formatDate(response.data.location.localtime_epoch * 1000);

    let city = response.data.location.name;
    let cityElement = document.querySelector("#current-city");
    cityElement.innerHTML = ` ${city}`;

    celciusTemperature = response.data.current.temp_c;

    let temperature = (celciusTemperature);
    let temperatureElement = document.querySelector("#today-temperature");
    temperatureElement.innerHTML = `${temperature}°C`; 

    let condition = response.data.current.condition.text;
    let conditionElement = document.querySelector("#today-condition");
    conditionElement.innerHTML = condition;

    let feel = response.data.current.feelslike_c;
    let feelElement = document.querySelector("#feel");
    feelElement.innerHTML = ` ${feel}°C`;

    let sunrise = response.data.forecast.forecastday[0].astro.sunrise;
    let sunriseElement = document.querySelector("#sunrise");
    sunriseElement.innerHTML = ` ${sunrise}`;

    let sunset = response.data.forecast.forecastday[0].astro.sunset;
    let sunsetElement = document.querySelector("#sunset");
    sunsetElement.innerHTML = ` ${sunset}`;

    let moonrise = response.data.forecast.forecastday[0].astro.moonrise;
    let moonriseElement = document.querySelector("#moonrise");
    moonriseElement.innerHTML = ` ${moonrise}`;

    let moonset = response.data.forecast.forecastday[0].astro.moonset;
    let moonsetElement = document.querySelector("#moonset");
    moonsetElement.innerHTML = ` ${moonset}`;

    let humidity = response.data.current.feelslike_c;
    let humidityElement = document.querySelector("#humidity");
    humidityElement.innerHTML = ` ${humidity}°C`;

    let highTemp = response.data.forecast.forecastday[0].day.maxtemp_c;
    let highTempElement = document.querySelector("#high-temp");
    highTempElement.innerHTML = `${highTemp}°C`

    let lowTemp = response.data.forecast.forecastday[0].day.mintemp_c;
    let lowTempElement = document.querySelector("#low-temp");
    lowTempElement.innerHTML = `${lowTemp}°C`

    let wind = Math.round(response.data.current.wind_kph);
    let windElement = document.querySelector("#wind");
    windElement.innerHTML = ` ${wind} km/h`;
    //hourly forecast starting from 05:00am
    let hour5Temp = response.data.forecast.forecastday[0].hour[5].temp_c;
    let hour5Element = document.querySelector("#hour-five");
    hour5Element.innerHTML = `${hour5Temp}°C`;

    let hour6Temp = response.data.forecast.forecastday[0].hour[6].temp_c;
    let hour6Element = document.querySelector("#hour-six");
    hour6Element.innerHTML = `${hour6Temp}°C`;

    let hour7Temp = response.data.forecast.forecastday[0].hour[7].temp_c;
    let hour7Element = document.querySelector("#hour-seven");
    hour7Element.innerHTML = `${hour7Temp}°C`;

    let hour8Temp = response.data.forecast.forecastday[0].hour[8].temp_c;
    let hour8Element = document.querySelector("#hour-eight");
    hour8Element.innerHTML = `${hour8Temp}°C`;

    let hour9Temp = response.data.forecast.forecastday[0].hour[9].temp_c;
    let hour9Element = document.querySelector("#hour-nine");
    hour9Element.innerHTML = `${hour9Temp}°C`;

    let hour10Temp = response.data.forecast.forecastday[0].hour[10].temp_c;
    let hour10Element = document.querySelector("#hour-ten");
    hour10Element.innerHTML = `${hour10Temp}°C`;

    let hour11Temp = response.data.forecast.forecastday[0].hour[11].temp_c;
    let hour11Element = document.querySelector("#hour-eleven");
    hour11Element.innerHTML = `${hour11Temp}°C`;

    let hour12Temp = response.data.forecast.forecastday[0].hour[12].temp_c;
    let hour12Element = document.querySelector("#hour-twelve");
    hour12Element.innerHTML = `${hour12Temp}°C`;

    let hour13Temp = response.data.forecast.forecastday[0].hour[13].temp_c;
    let hour13Element = document.querySelector("#hour-thirteen");
    hour13Element.innerHTML = `${hour13Temp}°C`;

    let hour14Temp = response.data.forecast.forecastday[0].hour[14].temp_c;
    let hour14Element = document.querySelector("#hour-fourteen");
    hour14Element.innerHTML = `${hour14Temp}°C`;

    let hour15Temp = response.data.forecast.forecastday[0].hour[15].temp_c;
    let hour15Element = document.querySelector("#hour-fifteen");
    hour15Element.innerHTML = `${hour15Temp}°C`;

    let hour16Temp = response.data.forecast.forecastday[0].hour[16].temp_c;
    let hour16Element = document.querySelector("#hour-sixteen");
    hour16Element.innerHTML = `${hour16Temp}°C`;

    let hour17Temp = response.data.forecast.forecastday[0].hour[17].temp_c;
    let hour17Element = document.querySelector("#hour-seventeen");
    hour17Element.innerHTML = `${hour17Temp}°C`;

    let hour18Temp = response.data.forecast.forecastday[0].hour[18].temp_c;
    let hour18Element = document.querySelector("#hour-eighteen");
    hour18Element.innerHTML = `${hour18Temp}°C`;

    let hour19Temp = response.data.forecast.forecastday[0].hour[19].temp_c;
    let hour19Element = document.querySelector("#hour-nineteen");
    hour19Element.innerHTML = `${hour19Temp}°C`;

    let hour20Temp = response.data.forecast.forecastday[0].hour[20].temp_c;
    let hour20Element = document.querySelector("#hour-twenty");
    hour20Element.innerHTML = `${hour20Temp}°C`;

    let hour21Temp = response.data.forecast.forecastday[0].hour[21].temp_c;
    let hour21Element = document.querySelector("#hour-twentyone");
    hour21Element.innerHTML = `${hour21Temp}°C`;

    let hour22Temp = response.data.forecast.forecastday[0].hour[22].temp_c;
    let hour22Element = document.querySelector("#hour-twentytwo");
    hour22Element.innerHTML = `${hour22Temp}°C`;

    let hour23Temp = response.data.forecast.forecastday[0].hour[23].temp_c;
    let hour23Element = document.querySelector("#hour-twentythree");
    hour23Element.innerHTML = `${hour23Temp}°C`;

    let hour0Temp = response.data.forecast.forecastday[0].hour[0].temp_c;
    let hour0Element = document.querySelector("#hour-zero");
    hour0Element.innerHTML = `${hour0Temp}°C`;

    let hour1Temp = response.data.forecast.forecastday[0].hour[1].temp_c;
    let hour1Element = document.querySelector("#hour-one");
    hour1Element.innerHTML = `${hour1Temp}°C`;

    let hour2Temp = response.data.forecast.forecastday[0].hour[2].temp_c;
    let hour2Element = document.querySelector("#hour-two");
    hour2Element.innerHTML = `${hour2Temp}°C`;

    let hour3Temp = response.data.forecast.forecastday[0].hour[3].temp_c;
    let hour3Element = document.querySelector("#hour-three");
    hour3Element.innerHTML = `${hour3Temp}°C`;

    let hour4Temp = response.data.forecast.forecastday[0].hour[4].temp_c;
    let hour4Element = document.querySelector("#hour-four");
    hour4Element.innerHTML = `${hour4Temp}°C`;
    
}

function search(city) {
    let apiKey = "b94fed5ef3a74832a4b112126221704";
    let apiUrl = `https://api.weatherapi.com/v1/forecast.json?key=${apiKey}&q=${city}&days=7&aqi=no&alerts=no`;
//https://api.weatherapi.com/v1/forecast.json?key=b94fed5ef3a74832a4b112126221704&q=Perth&days=7&aqi=no&alerts=no

    axios.get(apiUrl).then(showTodaysData);
}

function handleSubmit(event) {
    event.preventDefault();
    let searchInput = document.querySelector("#search-input");
    //console.log(searchInput.value);
    search(searchInput.value);
}

function convertUnitF() {
    
    let mainTemperature = document.querySelector("#today-temperature");
    fahrenheitTemperature = Math.round(celciusTemperature * 9 / 5) + 32;
    mainTemperature.innerHTML = `${fahrenheitTemperature}°F`;
    }
    
function convertUnitC(){

    let mainTemperature = document.querySelector("#today-temperature");
    mainTemperature.innerHTML = `${celciusTemperature}°C`;

}


let toggleFahrenheit = document.querySelector("#fahrenheit-label");
toggleFahrenheit.addEventListener("click", convertUnitF);

let celciusTemperature = null;


let toggleCelcius = document.querySelector("#celcius-label");
toggleCelcius.addEventListener("click", convertUnitC);

let form = document.querySelector("#search-form");
form.addEventListener("submit", handleSubmit);

search("Barcelona")